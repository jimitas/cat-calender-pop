<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POP CAT DAILY</title>

  <!-- Tailwind CSS (スタイリング用) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons (アイコン用) -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    /* ストライプ背景のカスタムスタイル */
    .bg-stripes-gray {
      background-color: #f3f4f6;
      background-image: linear-gradient(45deg, #e5e7eb 25%, transparent 25%, transparent 50%, #e5e7eb 50%, #e5e7eb 75%, transparent 75%, transparent);
      background-size: 20px 20px;
    }

    /* 読み込み中のアニメーション微調整 */
    @keyframes spin-slow {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    .animate-spin-slow {
      animation: spin-slow 3s linear infinite;
    }
  </style>
</head>

<body class="min-h-screen bg-yellow-400 flex flex-col items-center justify-center p-4 font-sans text-black relative overflow-hidden">

  <!-- 背景のドット装飾 -->
  <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(circle, #000 2px, transparent 2px); background-size: 24px 24px;">
  </div>

  <!-- タイトルエリア -->
  <div class="mb-8 relative z-10 transform -rotate-2">
    <div class="bg-blue-500 text-white px-6 py-2 border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]">
      <h1 class="text-4xl font-black tracking-tighter italic flex items-center gap-2">
        <i data-lucide="cat" class="w-8 h-8" stroke-width="3"></i>
        POP CAT DAILY
      </h1>
    </div>
  </div>

  <!-- カレンダー本体 -->
  <div class="relative bg-white w-full max-w-sm border-4 border-black shadow-[12px_12px_0px_0px_rgba(0,0,0,1)] z-10">

    <!-- ヘッダー部分 -->
    <div class="bg-red-500 border-b-4 border-black p-4 flex justify-between items-center text-white">
      <div id="year-display" class="font-black text-xl tracking-widest">2024</div>
      <div class="flex gap-1">
        <div class="w-3 h-3 bg-white rounded-full border-2 border-black"></div>
        <div class="w-3 h-3 bg-white rounded-full border-2 border-black"></div>
        <div class="w-3 h-3 bg-white rounded-full border-2 border-black"></div>
      </div>
    </div>

    <!-- 日付エリア -->
    <div class="p-6 text-center relative overflow-hidden">
      <!-- 背景の装飾文字 -->
      <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center opacity-5 pointer-events-none">
        <span class="text-9xl font-black">CAT</span>
      </div>

      <div class="flex justify-between items-end border-b-4 border-black pb-4 mb-4">
        <span class="text-4xl font-black italic text-blue-600">
          <span id="month-display">1</span>
          <span class="text-lg text-black not-italic font-bold">MONTH</span>
        </span>
        <div id="weekday-badge" class="px-3 py-1 border-2 border-black font-bold text-sm bg-yellow-300 text-black">
          SUNDAY
        </div>
      </div>

      <div class="flex flex-col items-center justify-center py-2 relative">
        <!-- 吹き出し風の日付 -->
        <div class="relative">
          <i data-lucide="zap" class="absolute -top-6 -right-8 w-12 h-12 text-yellow-400 fill-yellow-400 stroke-black stroke-2 animate-pulse"></i>
          <span id="day-display" class="text-9xl font-black leading-none tracking-tighter drop-shadow-[4px_4px_0px_rgba(0,0,0,0.2)]">
            1
          </span>
        </div>
      </div>
    </div>

    <!-- 猫の写真エリア -->
    <div class="px-4 pb-4">
      <div class="bg-black p-1">
        <div class="relative w-full aspect-[4/3] bg-stripes-gray overflow-hidden border-2 border-white group">

          <!-- ローディング表示 -->
          <div id="loading-view" class="absolute inset-0 bg-blue-400 flex flex-col items-center justify-center text-white border-2 border-black m-2 z-20">
            <div class="animate-spin mb-2">
              <i data-lucide="refresh-cw" class="w-10 h-10"></i>
            </div>
            <p class="font-bold text-xl uppercase">Loading...</p>
          </div>

          <!-- 画像表示 -->
          <img id="cat-image" src="" alt="Pop Cat" class="w-full h-full object-cover grayscale-0 hover:grayscale transition-all duration-300 hidden" />

          <!-- ポップなタグ -->
          <div id="cute-tag" class="absolute top-2 left-2 bg-yellow-400 text-black text-xs font-black px-2 py-1 border-2 border-black transform -rotate-6 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hidden z-10">
            WOW! SO CUTE!
          </div>
        </div>
      </div>

      <div class="mt-4 flex justify-center">
        <div class="bg-white border-2 border-black px-4 py-1 rounded-full text-xs font-bold shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">
          #CatOfTheDay
        </div>
      </div>
    </div>

    <!-- アクションボタン -->
    <div class="p-4 bg-stone-100 border-t-4 border-black">
      <button id="fetch-btn" class="w-full bg-green-400 hover:bg-green-500 border-4 border-black text-black font-black py-4 text-xl shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] transition-all flex items-center justify-center gap-2 active:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed">
        NEXT CAT!
        <i data-lucide="star" class="w-6 h-6 fill-black"></i>
      </button>
    </div>
  </div>

  <div class="mt-8 font-bold text-black bg-white px-2 py-1 border-2 border-black transform rotate-1">
    &copy; <span id="footer-year">2024</span> DAILY POP CAT
  </div>

  <!-- JavaScriptロジック -->
  <script>
    // DOM要素の取得
    const catImage = document.getElementById('cat-image');
    const loadingView = document.getElementById('loading-view');
    const cuteTag = document.getElementById('cute-tag');
    const fetchBtn = document.getElementById('fetch-btn');
    const yearDisplay = document.getElementById('year-display');
    const monthDisplay = document.getElementById('month-display');
    const dayDisplay = document.getElementById('day-display');
    const weekdayBadge = document.getElementById('weekday-badge');
    const footerYear = document.getElementById('footer-year');

    // 日付情報の更新
    function updateDate() {
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth() + 1;
      const day = now.getDate();
      const daysOfWeek = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];
      const dayOfWeek = daysOfWeek[now.getDay()];

      yearDisplay.textContent = year;
      monthDisplay.textContent = month;
      dayDisplay.textContent = day;
      weekdayBadge.textContent = dayOfWeek;
      footerYear.textContent = year;

      // 曜日に応じた色の変更
      weekdayBadge.className = 'px-3 py-1 border-2 border-black font-bold text-sm'; // クラスリセット
      if (now.getDay() === 0) { // Sunday
        weekdayBadge.classList.add('bg-red-400', 'text-white');
      } else if (now.getDay() === 6) { // Saturday
        weekdayBadge.classList.add('bg-blue-400', 'text-white');
      } else {
        weekdayBadge.classList.add('bg-yellow-300', 'text-black');
      }
    }

    // 猫の画像をAPIから取得
    async function fetchCat() {
      // ローディング状態にする
      loadingView.classList.remove('hidden');
      catImage.classList.add('hidden');
      cuteTag.classList.add('hidden');
      fetchBtn.disabled = true;
      fetchBtn.innerHTML = `LOADING...`;

      try {
        const response = await fetch('https://api.thecatapi.com/v1/images/search');
        const data = await response.json();

        if (data && data.length > 0) {
          const imgUrl = data[0].url;

          // 画像の読み込み完了を待つ
          const img = new Image();
          img.onload = () => {
            catImage.src = imgUrl;
            loadingView.classList.add('hidden');
            catImage.classList.remove('hidden');
            cuteTag.classList.remove('hidden');
            fetchBtn.disabled = false;
            // アイコンを再描画（innerHTMLで消えてしまうため）
            fetchBtn.innerHTML = `NEXT CAT! <i data-lucide="star" class="w-6 h-6 fill-black"></i>`;
            lucide.createIcons();
          };
          img.src = imgUrl;
        }
      } catch (error) {
        console.error('猫の画像の取得に失敗しました:', error);
        fetchBtn.disabled = false;
        fetchBtn.textContent = 'ERROR! TRY AGAIN';
      }
    }

    // 初期化処理
    document.addEventListener('DOMContentLoaded', () => {
      updateDate();
      fetchCat();

      // アイコンの初期化
      lucide.createIcons();

      // ボタンのイベントリスナー
      fetchBtn.addEventListener('click', fetchCat);
    });
  </script>
</body>

</html>